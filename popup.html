<!DOCTYPE html>
<html lang="ja">
  <head>
     <meta charset="UTF-8">
     <title>Sketchテニス予約</title>
     <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <!-- メイン画面 -->
      <div id="main-view">
        <img src="images/icon48.png" alt="アイコン" class="logo">
        <h1>Sketchテニス予約</h1>
        <p>実行したい操作のボタンを押してください。</p>
        <div class="button-group">
          <button id="apply-lottery-btn" class="btn btn-primary">抽選申し込み</button>
          <button id="check-result-btn" class="btn btn-secondary">抽選結果確認</button>
        </div>
        <div class="test-mode-container">
          <div class="test-mode-header">
            <label for="test-mode-checkbox">テストモード</label>
            <input type="checkbox" id="test-mode-checkbox">
          </div>
          <div id="test-date-controls" class="hidden">
            <label for="test-day-input">日付を指定 (1-31):</label>
            <input type="number" id="test-day-input" min="1" max="31">
          </div>
        </div>
        <p id="status" class="status-message"></p>
        <div class="account-upload-container">
          <div id="csv-upload-view">
            <label for="account-csv-upload" id="csv-upload-label">アカウントCSVをアップロード:</label>
            <div class="csv-upload-actions">
              <input type="file" id="account-csv-upload" accept=".csv">
              <button id="cancel-csv-update-btn" class="btn btn-secondary hidden">キャンセル</button>
            </div>
          </div>
          <div id="csv-manage-view" class="hidden">
            <p class="upload-status-message">アカウントCSVはアップロード済みです。</p>
            <div class="csv-manage-buttons">
              <button id="check-csv-btn" class="btn btn-secondary">アカウントCSVを確認する</button>
              <button id="update-csv-btn" class="btn btn-secondary">アカウントCSVを更新</button>
            </div>
          </div>
          <pre id="csv-preview" class="hidden"></pre>
        </div>
      </div>

      <!-- カレンダー画面 (最初は非表示) -->
      <div id="calendar-view" class="hidden">
        <div class="calendar-header">
          <button id="prev-month-btn" class="btn-nav">&lt;</button>
          <h2 id="calendar-month-year"></h2>
          <button id="next-month-btn" class="btn-nav">&gt;</button>
        </div>
        <div id="calendar-grid"></div>
        <div id="selection-summary" class="selection-summary">
          <div class="summary-item">
            <strong>使用アカウント数</strong>
            <span id="used-accounts-count">0</span>
          </div>
          <div class="summary-item">
            <strong>残りアカウント数</strong>
            <span id="remaining-accounts-count">0</span>
          </div>
        </div>
        <div id="selection-details-view" class="selection-details">
          <h3>申込内容</h3>
          <div id="selection-details-list">
            <p class="no-selection-message">選択された申込はありません。</p>
          </div>
        </div>
        <div class="button-group vertical">
          <button id="confirm-lottery-application-btn" class="btn btn-primary">抽選申込を確定</button>
          <button id="test-lottery-application-btn" class="btn btn-secondary btn-dev">抽選申込テスト (開発用)</button>
          <button id="confirm-selection-btn" class="btn btn-secondary hidden">申し込み日を確定</button>
          <button id="back-to-main-btn" class="btn btn-secondary">戻る</button>
        </div>
        <div id="status-display-area" class="status-display hidden">
          <strong>処理結果:</strong>
          <p id="status-text"></p>
          <div id="status-log-view" class="status-log hidden">
            <strong>詳細ログ:</strong>
            <pre id="status-log-text"></pre>
          </div>
        </div>
      </div>

      <!-- 時間帯選択モーダル (最初は非表示) -->
      <div id="time-slot-modal" class="modal-overlay hidden">
        <div class="modal-content">
          <h3 id="modal-date-header"></h3>
          <div id="modal-park-selector-container" class="modal-form-group"></div>
          <p>希望の時間帯を選択してください (複数選択可)。</p>
          <div id="time-slot-list"></div>
          <div class="modal-actions">
            <button id="confirm-time-btn" class="btn btn-primary">確定</button>
            <button id="cancel-time-btn" class="btn btn-secondary">キャンセル</button>
          </div>
        </div>
      </div>
    </div>
    <script src="popup.js" type="module"></script>
  </body>
</html>
